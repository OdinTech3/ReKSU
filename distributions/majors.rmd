---
title: "Distribution of Majors"
output: github_document
---

```{r setup, include=F}
knitr::opts_chunk$set(
  fig.path = "markdown_figs/data_preparation-"
)
```

```{r}
library(dplyr)
library(magrittr)
library(ggplot2)
```

```{r}
cob_rt <- read.csv("data/COB_RT_Data.csv", na.strings = c("", "XX"))
```

## Filter Students August 2011

```{r}
term_2011_df <- cob_rt %>% filter(TERM == 201180)
```

### Recode `NA` as `UNDECLARED`

```{r}
f1_seq1_df <-term_2011_df %>%
  select(F1SEQ1_MAJOR) %>%
  mutate_all(as.character) %>%
  replace_na(list(F1SEQ1_MAJOR = "UNDECLARED")) %>%
  mutate_all(as.factor)

summary(f1_seq1_df)
```

# Semester 1's Distribution of Majors 

```{r}
total_students <- term_2011_df %>%
  select(StudNum) %>%
  distinct() %>%
  count() %>% 
  use_series("n")

total_students
```


## Start of Semester's 1 Term

```{r}
f1seq1_majors <- term_2011_df %>%
  select(F1SEQ1_MAJOR) %>%
  group_by(F1SEQ1_MAJOR) %>%
  summarise(freq = n()) %>%
  mutate(Probability = freq/total_students) %>%
  arrange(desc(Probability))

head(f1seq1_majors)
```

```{r}
f1seq1_majors %>%
  select(F1SEQ1_MAJOR, Probability) %>%
  write.csv(file = "data/f1seq1_majors_prob_2011.csv", row.names = F)
```


